<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Quickstart" href="quickstart.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>1 - ⚡ Zap Basics ⚡ - zap 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">zap 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">zap 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Basic Usage</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/basic.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="1---⚡-Zap-Basics-⚡">
<h1>1 - ⚡ Zap Basics ⚡<a class="headerlink" href="#1---⚡-Zap-Basics-⚡" title="Link to this heading">¶</a></h1>
<p>In this notebook, we introduce the basic types and functionality in Zap. We will manually construct a small electricity network, solve a dispatch problem using both CVXPY and ADMM, and analyze the results.</p>
<ol class="arabic simple">
<li><p>Creating a Network</p></li>
<li><p>Solving Dispatch Problems</p></li>
<li><p>Analyzing Results</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">zap</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
</pre></div>
</div>
</div>
<section id="Creating-a-Network">
<h2>Creating a Network<a class="headerlink" href="#Creating-a-Network" title="Link to this heading">¶</a></h2>
<p>Networks in Zap consist of a <code class="docutils literal notranslate"><span class="pre">Network</span></code> object, which defines the underlying network, and a list of <code class="docutils literal notranslate"><span class="pre">Device</span></code> objects, which are electrical components attached to the network. Devices include generators, loads, transmission lines, batteries, and all other components that connect to the network. Devices can also be used to model financial contracts, such as bids and offers for energy or transmission congestion contracts.</p>
<section id="Constructing-Devices">
<h3>Constructing Devices<a class="headerlink" href="#Constructing-Devices" title="Link to this heading">¶</a></h3>
<p>First, let’s initialize a simple network with 3 nodes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">PowerNetwork</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now, let’s add a load to the network.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">Load</span><span class="p">(</span>
    <span class="n">num_nodes</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span>
    <span class="c1"># The terminal of the device is the node to which it connects</span>
    <span class="n">terminal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
    <span class="c1"># The load argument is a time series of the power consumed by the device</span>
    <span class="c1"># This is 2-d array, see more below!</span>
    <span class="n">load</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">]]),</span>
    <span class="c1"># This is the curtailment cost of the device, which we will assume is $500 / MWh</span>
    <span class="n">linear_cost</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">500.0</span><span class="p">]),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>All data passed to the device must be <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays or of a similar type (e.g., a PyTorch <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>). We can also create groups of devices at the same time. Let’s add two generators to the network.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">generators</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">Generator</span><span class="p">(</span>
    <span class="n">num_nodes</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span>
    <span class="c1"># Since we have two generators, we specify two terminals</span>
    <span class="n">terminal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
    <span class="c1"># Nominal capacity refers to the generator nameplate capacity</span>
    <span class="n">nominal_capacity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">50.0</span><span class="p">,</span> <span class="mf">25.0</span><span class="p">]),</span>
    <span class="c1"># This is the marginal cost of generation</span>
    <span class="n">linear_cost</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">]),</span>
    <span class="c1"># Emissions rates are optional, but useful for many applications</span>
    <span class="n">emission_rates</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">]),</span>
    <span class="c1"># Dynamic capacity refers to the time-varying capacity factor of each generator</span>
    <span class="n">dynamic_capacity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since we have two generators, we specify both their parameters at the same time. Some of the parameters, such as costs or dynamic capacities, can also time varying, in which case the user must pass a 2d-array of data. The first dimension of the data specifies which device is being referred to, and the second dimension of the data specifies the time period. If you pass a 1d-array, Zap will automatically assume this is a static quantity that does not change over time.</p>
<p>Finally, let’s initialize a few transmission lines to connect our network.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lines</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">ACLine</span><span class="p">(</span>
    <span class="n">num_nodes</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span>
    <span class="c1"># AC lines are two-terminal devices, so we specify both a source and sink terminal for each line</span>
    <span class="c1"># We will build the classic 3-bus &quot;triangle&quot; network</span>
    <span class="n">source_terminal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
    <span class="n">sink_terminal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <span class="n">nominal_capacity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">]),</span>
    <span class="c1"># This is the per-MW susceptance, so the susceptance of each line is its nominal capacity</span>
    <span class="c1"># times its susceptance</span>
    <span class="c1"># We will give the lines uniform total susceptance</span>
    <span class="n">susceptance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">/</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="mf">30.0</span><span class="p">]),</span>
    <span class="c1"># Lines can also have time-vary capacities to simulate outages or de-ratings</span>
    <span class="c1"># In this example, we will just make them static</span>
    <span class="n">capacity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>We will also add an electrical ground device to specify which node is the reference bus.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ground</span> <span class="o">=</span> <span class="n">zap</span><span class="o">.</span><span class="n">Ground</span><span class="p">(</span><span class="n">num_nodes</span><span class="o">=</span><span class="n">net</span><span class="o">.</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">terminal</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</section>
<section id="Putting-the-Network-Together">
<h3>Putting the Network Together<a class="headerlink" href="#Putting-the-Network-Together" title="Link to this heading">¶</a></h3>
<p>To finish up, we will create a list of device (groups). Together with the network and the time horizon, this list fully specifies an electrical network!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">devices</span> <span class="o">=</span> <span class="p">[</span><span class="n">load</span><span class="p">,</span> <span class="n">generators</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">ground</span><span class="p">]</span>
<span class="n">time_horizon</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">net</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="n">time_horizon</span>  <span class="c1"># Fully network specification</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(PowerNetwork(num_nodes=3),
 [Load(num_nodes=3, terminal=array([0]), nominal_capacity=array([[1.]]), min_power=array([[-10., -15., -20.]]), max_power=array([[0., 0., 0.]]), capital_cost=None, emission_rates=None, load=array([[10., 15., 20.]]), linear_cost=array([[500.]]), quadratic_cost=None),
  Generator(num_nodes=3, terminal=array([1, 2]), nominal_capacity=array([[50.],
         [25.]]), min_power=array([[0., 0., 0.],
         [0., 0., 0.]]), max_power=array([[0.1, 0.5, 0.1],
         [1. , 1. , 1. ]]), dynamic_capacity=array([[0.1, 0.5, 0.1],
         [1. , 1. , 1. ]]), linear_cost=array([[ 0.1],
         [30. ]]), quadratic_cost=None, capital_cost=None, emission_rates=array([[  0.],
         [500.]]), min_nominal_capacity=None, max_nominal_capacity=None),
  ACLine(num_nodes=3, source_terminal=array([0, 1, 2]), sink_terminal=array([1, 2, 0]), min_power=array([[-1.],
         [-1.],
         [-1.]]), max_power=array([[1.],
         [1.],
         [1.]]), linear_cost=array([[0.],
         [0.],
         [0.]]), quadratic_cost=None, nominal_capacity=array([[10.],
         [20.],
         [30.]]), capital_cost=None, slack=0.0, min_nominal_capacity=None, max_nominal_capacity=None, reconductoring_cost=None, reconductoring_threshold=None),
  Ground(num_nodes=3, terminal=array([0]), voltage=array([[0.]]))],
 3)
</pre></div></div>
</div>
<p>Before we move on, here are a couple of notes about constructing devices.</p>
<ul class="simple">
<li><p>Many arguments (capital cost, emissions rates, line slacks, etc.) are optional and introduce additional functionality, e.g., for planning studies.</p></li>
<li><p>For performance reasons, it’s best to specify a few device groups (ideally, one for each type of device) with many devices per group, instead of many groups with one or just a few devices per group. This is so that computations can be efficiently vectorized, both on CPU and GPU machines.</p></li>
<li><p>Remember that the first dimension (rows) of a parameter specifies which device in the group the parameter is for, and the second dimension (columns) specifies the time period. <strong>Dynamic data is always 2-dimensional!</strong></p></li>
</ul>
</section>
</section>
<section id="Solving-Dispatch-Problems">
<h2>Solving Dispatch Problems<a class="headerlink" href="#Solving-Dispatch-Problems" title="Link to this heading">¶</a></h2>
<p>Now that we’ve defined an electricity dispatch problem, let’s solve using two different methods.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> - This method will build a model in <code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> and send it to an off-the-shelf solver, such as ECOS or Clarabel. You can also use commerical solvers like Mosek. This approach is best for small to medium problems and finds highly accurate solutions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">admm</span></code> - This method will use a PyTorch implementation of the alternating direction method of multipliers (ADMM). This can be run on either a CPU or GPU and scales well to larger problems. In general, this method is only capable of finding medium accuracy solutions within a reasonable amount of time.</p></li>
</ol>
<section id="Solving-with-CVXPY">
<h3>Solving with CVXPY<a class="headerlink" href="#Solving-with-CVXPY" title="Link to this heading">¶</a></h3>
<p>To solve with <code class="docutils literal notranslate"><span class="pre">cvxpy</span></code>, we simply call <code class="docutils literal notranslate"><span class="pre">net.dispatch</span></code> on our devices and (optionally) specify a solver.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outcome</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">dispatch</span><span class="p">(</span><span class="n">devices</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">CLARABEL</span><span class="p">,</span> <span class="n">add_ground</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">outcome</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DispatchOutcome(phase_duals=[None, None, [array([[-7.21619994e-08, -1.48353913e+01, -5.69716112e-07],
       [-7.21620029e-08, -1.48353913e+01, -5.69716118e-07],
       [-7.21619968e-08, -1.48353913e+01, -5.69716103e-07]]), array([[7.21620016e-08, 1.48353913e+01, 5.69716116e-07],
       [7.21619999e-08, 1.48353913e+01, 5.69716109e-07],
       [7.21619944e-08, 1.48353913e+01, 5.69716097e-07]])], [array([[ 5.02100773e-15, -2.31869585e-15,  1.46905872e-14]])]], local_equality_duals=[[], [], [array([[29.99999974, 29.77078293, 30.00000068],
       [29.99999942,  0.10000012, 29.99999949],
       [29.9999996 , 14.93539156, 30.00000011]]), array([[7.21619994e-08, 1.48353913e+01, 5.69716112e-07],
       [7.21620041e-08, 1.48353913e+01, 5.69716121e-07],
       [7.21619944e-08, 1.48353913e+01, 5.69716097e-07]])], [array([[29.99999974, 29.77078293, 30.00000068]]), array([[ 5.02100773e-15, -2.31869585e-15,  1.46905872e-14]])]], local_inequality_duals=[[array([[470.0000004 , 470.22921717, 469.99999943]]), array([[1.40746090e-07, 9.60038240e-08, 1.09352091e-07]])], [array([[4.28799138e-07, 1.78300241e-07, 3.37175404e-07],
       [4.56793016e-07, 1.50646085e+01, 1.61228178e-07]]), array([[2.98999998e+01, 3.03066738e-07, 2.98999998e+01],
       [6.01385815e-08, 4.00736531e-08, 2.74690419e-07]])], [array([[4.04079311e-07, 4.45061741e+01, 1.83415172e-06],
       [7.31746157e-08, 6.55602650e-08, 9.83955076e-08],
       [5.59249063e-08, 5.71740987e-08, 6.12132993e-08]]), array([[9.44655495e-08, 7.82423597e-08, 9.86035365e-08],
       [1.17743892e-07, 1.51057653e-07, 1.05392772e-07],
       [9.05760184e-08, 7.98719289e-08, 6.55684197e-08]])], []], local_variables=[None, None, None, None], power=[[array([[-10., -15., -20.]])], [array([[5.00000000e+00, 1.50000000e+01, 4.99999999e+00],
       [5.00000001e+00, 9.03717974e-09, 1.50000000e+01]])], [array([[ 5.00000000e+00,  1.00000000e+01,  8.33333333e+00],
       [ 3.64665045e-09, -4.99999999e+00,  3.33333334e+00],
       [-5.00000000e+00, -5.00000000e+00, -1.16666667e+01]]), array([[-5.00000000e+00, -1.00000000e+01, -8.33333333e+00],
       [-3.64607602e-09,  4.99999999e+00, -3.33333334e+00],
       [ 5.00000000e+00,  5.00000000e+00,  1.16666667e+01]])], [array([[ 2.59944050e-13, -1.01386661e-13, -6.75087621e-13]])]], angle=[None, None, [array([[-7.14401061e-14,  8.38978856e-14, -5.64017010e-13],
       [ 5.00000000e+00,  1.00000000e+01,  8.33333333e+00],
       [ 5.00000000e+00,  5.00000000e+00,  1.16666667e+01]]), array([[ 5.00000000e+00,  1.00000000e+01,  8.33333333e+00],
       [ 5.00000000e+00,  5.00000000e+00,  1.16666667e+01],
       [ 7.14401067e-14, -8.38978841e-14,  5.64017011e-13]])], [array([[1.19208492e-22, 3.02650078e-22, 2.33199737e-22]])]], prices=array([[29.99999974, 29.77078293, 30.00000068],
       [29.99999942,  0.10000012, 29.99999949],
       [29.9999996 , 14.93539156, 30.00000011]]), global_angle=array([[2.38416984e-22, 6.05300156e-22, 4.66399474e-22],
       [5.00000000e+00, 1.00000000e+01, 8.33333333e+00],
       [5.00000000e+00, 5.00000000e+00, 1.16666667e+01]]), problem=Problem(Minimize(Expression(AFFINE, UNKNOWN, ())), [Equality(Expression(AFFINE, UNKNOWN, (3, 3)), Constant(CONSTANT, ZERO, ())), Equality(Expression(AFFINE, UNKNOWN, (3, 3)), Variable((3, 3), var7)), Equality(Expression(AFFINE, UNKNOWN, (3, 3)), Variable((3, 3), var8)), Equality(Expression(AFFINE, UNKNOWN, (1, 3)), Variable((1, 3), var9)), Equality(Expression(AFFINE, UNKNOWN, (3, 3)), Constant(CONSTANT, ZERO, ())), Equality(Expression(AFFINE, UNKNOWN, (3, 3)), Constant(CONSTANT, ZERO, ())), Equality(Variable((1, 3), var6), Constant(CONSTANT, ZERO, ())), Equality(Expression(AFFINE, UNKNOWN, (1, 3)), Constant(CONSTANT, ZERO, ())), Inequality(Expression(AFFINE, UNKNOWN, (1, 3))), Inequality(Expression(AFFINE, UNKNOWN, (1, 3))), Inequality(Expression(AFFINE, UNKNOWN, (2, 3))), Inequality(Expression(AFFINE, UNKNOWN, (2, 3))), Inequality(Expression(AFFINE, UNKNOWN, (3, 3))), Inequality(Expression(AFFINE, UNKNOWN, (3, 3)))]), ground=None)
</pre></div></div>
</div>
<p>As you can see, the result of a grid dispatch is a complicated object. We will address that in a second.</p>
</section>
<section id="Solving-with-ADMM">
<h3>Solving with ADMM<a class="headerlink" href="#Solving-with-ADMM" title="Link to this heading">¶</a></h3>
<p>Solving with ADMM is a little more complicated and requires two steps:</p>
<ol class="arabic simple">
<li><p>Transfering device data to PyTorch</p></li>
<li><p>Initializing an ADMM solver object.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">machine</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>  <span class="c1"># Pick &quot;cuda&quot; for a machine with an Nvidia GPU</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">float32</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">zap.admm</span> <span class="kn">import</span> <span class="n">ADMMSolver</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">admm_devices</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">torchify</span><span class="p">(</span><span class="n">machine</span><span class="o">=</span><span class="n">machine</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">admm</span> <span class="o">=</span> <span class="n">ADMMSolver</span><span class="p">(</span>
    <span class="n">machine</span><span class="o">=</span><span class="n">machine</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">solution_admm</span><span class="p">,</span> <span class="n">history_admm</span> <span class="o">=</span> <span class="n">admm</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">admm_devices</span><span class="p">,</span> <span class="n">time_horizon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ADMM converged in 468 iterations.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution_admm</span><span class="o">.</span><span class="n">power</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[tensor([[-10., -15., -20.]])],
 [tensor([[ 5.0000, 15.0000,  5.0000],
          [ 5.0001,  0.0000, 15.0001]])],
 [tensor([[ 5.0000e+00,  1.0000e+01,  8.3333e+00],
          [ 2.9945e-05, -5.0000e+00,  3.3334e+00],
          [-5.0000e+00, -5.0000e+00, -1.1667e+01]]),
  tensor([[-5.0000e+00, -1.0000e+01, -8.3333e+00],
          [-2.9945e-05,  5.0000e+00, -3.3334e+00],
          [ 5.0000e+00,  5.0000e+00,  1.1667e+01]])],
 [tensor([[0., 0., 0.]])]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ADMM solutions need to be cast to a standard DispatchOutcome</span>
<span class="n">outcome_admm</span> <span class="o">=</span> <span class="n">solution_admm</span><span class="o">.</span><span class="n">as_outcome</span><span class="p">()</span>

<span class="n">outcome_admm</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
DispatchOutcome(phase_duals=[None, None, [tensor([[-3.3689e-05,  3.5381e+00,  3.5673e-05],
        [-2.6349e-05,  3.5381e+00,  5.4371e-05],
        [ 1.9117e-05,  3.5381e+00, -2.1447e-05]]), tensor([[ 1.8560e-05, -3.5381e+00, -1.4193e-05],
        [-1.1102e-05, -3.5381e+00,  9.2870e-06],
        [-4.8603e-05, -3.5381e+00,  7.4019e-05]])], [tensor([[ 8.0933e-05,  2.5490e-05, -1.1069e-04]])]], local_equality_duals=None, local_inequality_duals=None, local_variables=[None, None, None, None], power=[[tensor([[-10., -15., -20.]])], [tensor([[ 5.0000, 15.0000,  5.0000],
        [ 5.0001,  0.0000, 15.0001]])], [tensor([[ 5.0000e+00,  1.0000e+01,  8.3333e+00],
        [ 2.9945e-05, -5.0000e+00,  3.3334e+00],
        [-5.0000e+00, -5.0000e+00, -1.1667e+01]]), tensor([[-5.0000e+00, -1.0000e+01, -8.3333e+00],
        [-2.9945e-05,  5.0000e+00, -3.3334e+00],
        [ 5.0000e+00,  5.0000e+00,  1.1667e+01]])], [tensor([[0., 0., 0.]])]], angle=[None, None, [tensor([[1.1444e-05, 0.0000e+00, 1.2398e-05],
        [5.0000e+00, 1.0000e+01, 8.3334e+00],
        [5.0001e+00, 5.0000e+00, 1.1667e+01]]), tensor([[5.0000e+00, 1.0000e+01, 8.3334e+00],
        [5.0001e+00, 5.0000e+00, 1.1667e+01],
        [1.2398e-05, 0.0000e+00, 1.3351e-05]])], [tensor([[0., 0., 0.]])]], prices=tensor([[30.0001,  7.1762, 29.9998],
        [30.0001,  0.1000, 29.9998],
        [30.0000,  3.6381, 29.9999]]), global_angle=None, problem=None, ground=None)
</pre></div></div>
</div>
</section>
</section>
<section id="Analyzing-Results">
<h2>Analyzing Results<a class="headerlink" href="#Analyzing-Results" title="Link to this heading">¶</a></h2>
<p>Results are packaged into a hierachically structured <code class="docutils literal notranslate"><span class="pre">DispatchOutcome</span></code> object.</p>
<ol class="arabic simple">
<li><p>At the top level, a <code class="docutils literal notranslate"><span class="pre">DispatchOutcome</span></code> has several fields: <code class="docutils literal notranslate"><span class="pre">power</span></code>, <code class="docutils literal notranslate"><span class="pre">angle</span></code>, <code class="docutils literal notranslate"><span class="pre">prices</span></code>, and a few others. You can access these fields like any other Python field, e.g., <code class="docutils literal notranslate"><span class="pre">outcome.power</span></code>.</p></li>
<li><p>Each field contains either <em>device-specific information</em> or <em>global information</em>. Device-specific fields will contain a list of length <code class="docutils literal notranslate"><span class="pre">len(devices)</span></code>, where the <code class="docutils literal notranslate"><span class="pre">i</span></code>th entry in the list contains information specific to the <code class="docutils literal notranslate"><span class="pre">i</span></code>th device. Global fields contain a 2d array of size <code class="docutils literal notranslate"><span class="pre">(num_nodes,</span> <span class="pre">time_horizon)</span></code>. You can access the information for device <code class="docutils literal notranslate"><span class="pre">i</span></code> using normal indexing, e.g., <code class="docutils literal notranslate"><span class="pre">outcome.power[i]</span></code>.</p></li>
<li><p>For device-specific information, each block of information is further broken down by the <em>terminal</em> of the device. Many devices, such as generator, loads, and batteries, have just a single terminal and will always be indexed as <code class="docutils literal notranslate"><span class="pre">outcome.power[i][0]</span></code>. Some devices, like transmission lines, have two or more terminals. The data for terminal <code class="docutils literal notranslate"><span class="pre">j</span></code> is stored in <code class="docutils literal notranslate"><span class="pre">outcome.power[i][j]</span></code>.</p></li>
<li><p>Finally, the data for terminal <code class="docutils literal notranslate"><span class="pre">j</span></code> of device <code class="docutils literal notranslate"><span class="pre">i</span></code> is just a 2d array of size <code class="docutils literal notranslate"><span class="pre">(num_devices,</span> <span class="pre">time_horizon)</span></code>, where <code class="docutils literal notranslate"><span class="pre">num_devices</span> <span class="pre">=</span> <span class="pre">devices[i].num_devices</span></code> is the number of devices in device group <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outcome</span><span class="o">.</span><span class="n">prices</span>  <span class="c1"># Global</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[29.99999974, 29.77078293, 30.00000068],
       [29.99999942,  0.10000012, 29.99999949],
       [29.9999996 , 14.93539156, 30.00000011]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outcome</span><span class="o">.</span><span class="n">power</span>  <span class="c1"># Device-specific</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[array([[-10., -15., -20.]])],
 [array([[5.00000000e+00, 1.50000000e+01, 4.99999999e+00],
         [5.00000001e+00, 9.03717974e-09, 1.50000000e+01]])],
 [array([[ 5.00000000e+00,  1.00000000e+01,  8.33333333e+00],
         [ 3.64665045e-09, -4.99999999e+00,  3.33333334e+00],
         [-5.00000000e+00, -5.00000000e+00, -1.16666667e+01]]),
  array([[-5.00000000e+00, -1.00000000e+01, -8.33333333e+00],
         [-3.64607602e-09,  4.99999999e+00, -3.33333334e+00],
         [ 5.00000000e+00,  5.00000000e+00,  1.16666667e+01]])],
 [array([[ 2.59944050e-13, -1.01386661e-13, -6.75087621e-13]])]]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outcome</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># Power flows for device 2, which we made the transmission lines</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([[ 5.00000000e+00,  1.00000000e+01,  8.33333333e+00],
        [ 3.64665045e-09, -4.99999999e+00,  3.33333334e+00],
        [-5.00000000e+00, -5.00000000e+00, -1.16666667e+01]]),
 array([[-5.00000000e+00, -1.00000000e+01, -8.33333333e+00],
        [-3.64607602e-09,  4.99999999e+00, -3.33333334e+00],
        [ 5.00000000e+00,  5.00000000e+00,  1.16666667e+01]])]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Indexing the second terminal of the lines---the result is an object of size (num_ac_lines, time_horizon)</span>
<span class="n">outcome</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-5.00000000e+00, -1.00000000e+01, -8.33333333e+00],
       [-3.64607602e-09,  4.99999999e+00, -3.33333334e+00],
       [ 5.00000000e+00,  5.00000000e+00,  1.16666667e+01]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Indexing the first (and only) terminal of the generators</span>
<span class="n">outcome</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[5.00000000e+00, 1.50000000e+01, 4.99999999e+00],
       [5.00000001e+00, 9.03717974e-09, 1.50000000e+01]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Power output of generator 0 at timestep 2</span>
<span class="n">outcome</span><span class="o">.</span><span class="n">power</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4.999999989280596
</pre></div></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="quickstart.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Quickstart</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Anthony Degleris
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">1 - ⚡ Zap Basics ⚡</a><ul>
<li><a class="reference internal" href="#Creating-a-Network">Creating a Network</a><ul>
<li><a class="reference internal" href="#Constructing-Devices">Constructing Devices</a></li>
<li><a class="reference internal" href="#Putting-the-Network-Together">Putting the Network Together</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Solving-Dispatch-Problems">Solving Dispatch Problems</a><ul>
<li><a class="reference internal" href="#Solving-with-CVXPY">Solving with CVXPY</a></li>
<li><a class="reference internal" href="#Solving-with-ADMM">Solving with ADMM</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Analyzing-Results">Analyzing Results</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=01f34227"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>